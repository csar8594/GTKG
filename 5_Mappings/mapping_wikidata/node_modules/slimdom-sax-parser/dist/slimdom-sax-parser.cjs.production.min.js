"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n,t=require("slimdom"),e=(n=t)&&"object"==typeof n&&"default"in n?n.default:n,o=require("saxes"),i=require("stream"),r={xmlns:!0,position:!1,additionalEntities:{}},a={"":null,xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function s(){return(s=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n}).apply(this,arguments)}var u={getCurrentPosition:function(){return{offset:0,line:0,column:0}},trackAttributePosition:function(n){return n},trackNodeClosePosition:function(n){return n},trackNodePosition:function(n){return n},updateLastTrackedPosition:function(){}};function c(n,t){var o=new e.Document,i=o,r=function(n){var t=[a];return void 0!==n&&t.unshift(n),{push:function(n){return t.unshift(n)},pop:function(){return t.shift()},location:function(n){var e;return void 0===n?n:null==(e=t.find((function(t){return void 0!==t[n]})))?void 0:e[n]}}}(t.additionalNamespaces||{}),s=t.position?function(n){var t={line:1,column:1,offset:0};function e(t){var e={offset:n.position,line:n.line,column:n.column+1};return t?(3===t.nodeType?(e.offset--,e.column--):8===t.nodeType&&(e.offset++,e.column++),e):e}return{getCurrentPosition:e,trackAttributePosition:function(n,t){return n.position={end:t.offset},n},trackNodeClosePosition:function(n){var o=e(n);return n.closePosition={line:t.line,column:t.column,start:t.offset,end:o.offset},t=o,n},trackNodePosition:function(n){var o=e(n);return n.position={line:t.line,column:t.column,start:t.offset,end:o.offset},t=o,n},updateLastTrackedPosition:function(){t=e()}}}(n):u,c=s.trackNodePosition,l=s.trackNodeClosePosition,d=s.updateLastTrackedPosition,f=s.getCurrentPosition,p=s.trackAttributePosition,m=new Map;return{onText:function(n){if(i!==o){var t=c(o.createTextNode(n));i.appendChild(t)}else d()},onOpenTag:function(n){n.ns&&r.push(n.ns);var t=r.location(n.prefix);if(void 0===t)throw new Error('Could not resolve a namespace location for "'+n.prefix+'"');var e=c(o.createElementNS(t,n.name));Object.keys(n.attributes).map((function(t){return n.attributes[t]})).forEach((function(n){if("string"!=typeof n){var t=""===n.prefix?null:r.location(n.prefix);""===n.prefix&&"xmlns"===n.name&&(t=r.location("xmlns"));var i=m.get(n.name),a=p(o.createAttributeNS(t,n.name),i);a.value=n.value,e.setAttributeNode(a)}})),i.appendChild(e),i=e},onOpenTagStart:function(){m=new Map},onAttribute:function(n){m.set(n.name,f())},onCloseTag:function(){if(l(i),!i.parentNode)throw new Error("End of the line!");i=i.parentNode,r.pop()},onProcessingInstruction:function(n){i.appendChild(c(o.createProcessingInstruction(n.target,n.body)))},onComment:function(n){i.appendChild(c(o.createComment(n)))},onDocType:function(n){var t,e,r,a,s=(e=(t=function(n,t){var e;void 0===t&&(t=0);var o=[],i=/'[^']+'|"[^"]+"|[^\s<>/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=t,i.exec(n);e=i.exec(n);)if(o.push(e[0]),e[1])return o;return o}("<!DOCTYPE "+n+">"))[1],r=t[3],a=t[4],"PUBLIC"===t[2]?{qualifiedName:e,publicId:r.replace(/^"(.*)"$/,"$1"),systemId:(null==a?void 0:a.replace(/^"(.*)"$/,"$1"))||null}:{qualifiedName:e,publicId:null,systemId:r.replace(/^"(.*)"$/,"$1")});i.appendChild(c(o.implementation.createDocumentType(s.qualifiedName,s.publicId||"",s.systemId||"")))},onCdata:function(n){i.appendChild(c(o.createCDATASection(n)))},document:o}}var l=t;exports.DEFAULT_NAMESPACES=a,exports.DEFAULT_OPTIONS=r,exports.async=function(n,t){return new Promise((function(e,a){var u=s({},r,t),l=new o.SaxesParser(u),d=c(l,u);if(l.on("attribute",d.onAttribute),l.on("cdata",d.onCdata),l.on("closetag",d.onCloseTag),l.on("comment",d.onComment),l.on("doctype",d.onDocType),l.on("error",(function(n){a(n)})),l.on("opentag",d.onOpenTag),l.on("opentagstart",d.onOpenTagStart),l.on("processinginstruction",d.onProcessingInstruction),l.on("text",d.onText),void 0!==t&&void 0!==t.additionalEntities)for(var f=0,p=Object.entries(t.additionalEntities);f<p.length;f++){var m=p[f];l.ENTITIES[m[0]]=m[1]}return"string"==typeof n?(l.write(n).close(),void e(d.document)):n instanceof i.Readable?(n.on("readable",(function(){for(var t;t=n.read(n.readableHighWaterMark||8192);)l.write(t)})),void n.on("end",(function(){l.close(),e(d.document)}))):void a(new Error("Unsupported input type "+typeof n+"."))}))},exports.slimdom=l,exports.sync=function(n,t){var e=s({},r,t),i=new o.SaxesParser(e),a=c(i,e);if(i.on("attribute",a.onAttribute),i.on("cdata",a.onCdata),i.on("closetag",a.onCloseTag),i.on("comment",a.onComment),i.on("doctype",a.onDocType),i.on("opentag",a.onOpenTag),i.on("opentagstart",a.onOpenTagStart),i.on("processinginstruction",a.onProcessingInstruction),i.on("text",a.onText),void 0!==t&&void 0!==t.additionalEntities)for(var u=0,l=Object.entries(t.additionalEntities);u<l.length;u++){var d=l[u];i.ENTITIES[d[0]]=d[1]}return i.write(n).close(),a.document};
//# sourceMappingURL=slimdom-sax-parser.cjs.production.min.js.map
